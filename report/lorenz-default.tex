\begin{Verbatim}[commandchars=\\\{\},numbers=left,firstnumber=1,stepnumber=1]
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{include \PYZlt{}iostream\PYZgt{}}
\PY{c+cp}{\PYZsh{}}\PY{c+cp}{include \PYZlt{}boost}\PY{c+cp}{/}\PY{c+cp}{array.hpp\PYZgt{}}

\PY{c+cp}{\PYZsh{}}\PY{c+cp}{include \PYZlt{}boost}\PY{c+cp}{/}\PY{c+cp}{numeric}\PY{c+cp}{/}\PY{c+cp}{odeint.hpp\PYZgt{}}

\PY{k}{using} \PY{k}{namespace} \PY{n}{std}\PY{p}{;}
\PY{k}{using} \PY{k}{namespace} \PY{n}{boost}\PY{o}{:}\PY{o}{:}\PY{n}{numeric}\PY{o}{:}\PY{o}{:}\PY{n}{odeint}\PY{p}{;}

\PY{k}{const} \PY{k+kt}{double} \PY{n}{sigma} \PY{o}{=} \PY{l+m+mf}{10.0}\PY{p}{;}
\PY{k}{const} \PY{k+kt}{double} \PY{n}{R} \PY{o}{=} \PY{l+m+mf}{28.0}\PY{p}{;}
\PY{k}{const} \PY{k+kt}{double} \PY{n}{b} \PY{o}{=} \PY{l+m+mf}{8.0} \PY{o}{/} \PY{l+m+mf}{3.0}\PY{p}{;}

\PY{k}{typedef} \PY{n}{boost}\PY{o}{:}\PY{o}{:}\PY{n}{array}\PY{o}{\PYZlt{}} \PY{k+kt}{double} \PY{p}{,} \PY{l+m+mi}{3} \PY{o}{\PYZgt{}} \PY{n}{state\PYZus{}type}\PY{p}{;}

\PY{k+kt}{void} \PY{n+nf}{lorenz}\PY{p}{(} \PY{k}{const} \PY{n}{state\PYZus{}type} \PY{o}{\PYZam{}}\PY{n}{x} \PY{p}{,} \PY{n}{state\PYZus{}type} \PY{o}{\PYZam{}}\PY{n}{dxdt} \PY{p}{,} \PY{k+kt}{double} \PY{n}{t} \PY{p}{)}
\PY{p}{\PYZob{}}
    \PY{n}{dxdt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{sigma} \PY{o}{*} \PY{p}{(} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{p}{)}\PY{p}{;}
    \PY{n}{dxdt}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{R} \PY{o}{*} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{;}
    \PY{n}{dxdt}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{b} \PY{o}{*} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{;}
\PY{p}{\PYZcb{}}

\PY{k+kt}{void} \PY{n+nf}{write\PYZus{}lorenz}\PY{p}{(} \PY{k}{const} \PY{n}{state\PYZus{}type} \PY{o}{\PYZam{}}\PY{n}{x} \PY{p}{,} \PY{k}{const} \PY{k+kt}{double} \PY{n}{t} \PY{p}{)}
\PY{p}{\PYZob{}}
    \PY{n}{cout} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{n}{t} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{l+s+sc}{\PYZsq{}\PYZbs{}t\PYZsq{}} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{l+s+sc}{\PYZsq{}\PYZbs{}t\PYZsq{}} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{l+s+sc}{\PYZsq{}\PYZbs{}t\PYZsq{}} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{\PYZlt{}} \PY{n}{endl}\PY{p}{;}
\PY{p}{\PYZcb{}}

\PY{k+kt}{int} \PY{n+nf}{main}\PY{p}{(}\PY{k+kt}{int} \PY{n}{argc}\PY{p}{,} \PY{k+kt}{char} \PY{o}{*}\PY{o}{*}\PY{n}{argv}\PY{p}{)}
\PY{p}{\PYZob{}}
    \PY{n}{state\PYZus{}type} \PY{n}{x} \PY{o}{=} \PY{p}{\PYZob{}} \PY{l+m+mf}{10.0} \PY{p}{,} \PY{l+m+mf}{1.0} \PY{p}{,} \PY{l+m+mf}{1.0} \PY{p}{\PYZcb{}}\PY{p}{;} \PY{c+c1}{// initial conditions}
    \PY{n}{integrate}\PY{p}{(} \PY{n}{lorenz} \PY{p}{,} \PY{n}{x} \PY{p}{,} \PY{l+m+mf}{0.0} \PY{p}{,} \PY{l+m+mf}{25.0} \PY{p}{,} \PY{l+m+mf}{0.1} \PY{p}{,} \PY{n}{write\PYZus{}lorenz} \PY{p}{)}\PY{p}{;}
\PY{p}{\PYZcb{}}
\end{Verbatim}
